stages: 
    - build
    - test
    - deploy

.build website:
    image: node:16-alpine
    stage: build
    script:
      - yarn install
      - yarn build
    artifacts: 
      paths:
        - build

.test websites:
    image: node:16-alpine
    stage: test
    script:
      - yarn global add serve
      - apk add curl
      - serve -s build &
      - sleep 10
      - curl http://localhost:3000 | grep "React App"

.unit test:
    image: node:16-alpine
    stage: test
    script:
      - yarn install
      - yarn test


deploy to web:
    image: 
      name: google/cloud-sdk:452.0.1-alpine
      entrypoint: [""]
    script: 
      - echo "Omo mehn i dey try" > omo.txt
      - gcloud --version
      - gcloud auth activate-service-account --key-file $GOOGLE_SERVICE_ACCOUNT
      - gcloud storage buckets create gs://$GOOGLE_BUCKET --default-storage-class=STANDARD --uniform-bucket-level-access
      - gcloud storage cp omo.txt gs://$GOOGLE_BUCKET/omo.txt